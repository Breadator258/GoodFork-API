<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>api/models/Measurement.js - The Good Fork - API</title>
    
    <meta name="description" content="Online documentation of the good fork api" />
    
        <meta name="keywords" content="the, good, fork, api, doc, documentation" />
        <meta name="keyword" content="the, good, fork, api, doc, documentation" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/Breadator258/3PROJ-WEB_API" target="_blank" class="menu-item" id="github_link" >GitHub</a></h2><h2><a href="./api_routes.html" class="menu-item" id="api_routes_link" >API Routes</a></h2><h3>Classes</h3><ul><li><a href="ModelError.html">ModelError</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ModelError.html#.code">code</a></li><li data-type='method' style='display: none;'><a href="ModelError.html#.message">message</a></li><li data-type='method' style='display: none;'><a href="ModelError.html#.fields">fields</a></li><li data-type='method' style='display: none;'><a href="ModelError.html#.json">json</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-middlewares.html">middlewares</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-middlewares.html#~checkParams">checkParams</a></li><li data-type='method' style='display: none;'><a href="module-middlewares.html#~database">database</a></li><li data-type='method' style='display: none;'><a href="module-middlewares.html#~toLowercase">toLowercase</a></li></ul></li><li></li><li></li><li></li><li><a href="module-models_Booking.html">models/Booking</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~getByUserId">getByUserId</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~getActiveByUserId">getActiveByUserId</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~getAllActive">getAllActive</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~getAllToday">getAllToday</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~buildBookings">buildBookings</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-models_Booking.html#~delete">delete</a></li></ul></li><li><a href="module-models_Measurement.html">models/Measurement</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Measurement.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_Measurement.html#~getByName">getByName</a></li><li data-type='method' style='display: none;'><a href="module-models_Measurement.html#~getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="module-models_Measurement.html#~getAllByTypes">getAllByTypes</a></li><li data-type='method' style='display: none;'><a href="module-models_Measurement.html#~convert">convert</a></li><li data-type='method' style='display: none;'><a href="module-models_Measurement.html#~buildMeasurement">buildMeasurement</a></li></ul></li><li><a href="module-models_MeasurementType.html">models/MeasurementType</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_MeasurementType.html#~getAll">getAll</a></li></ul></li><li><a href="module-models_MeasurementUnit.html">models/MeasurementUnit</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_MeasurementUnit.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_MeasurementUnit.html#~getAll">getAll</a></li></ul></li><li><a href="module-models_Menu.html">models/Menu</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~addIngredient">addIngredient</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~buildMenus">buildMenus</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~setIllustration">setIllustration</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~updateIngredient">updateIngredient</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~delete">delete</a></li><li data-type='method' style='display: none;'><a href="module-models_Menu.html#~deleteIngredient">deleteIngredient</a></li></ul></li><li><a href="module-models_MenuTypes.html">models/MenuTypes</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_MenuTypes.html#~getByName">getByName</a></li><li data-type='method' style='display: none;'><a href="module-models_MenuTypes.html#~getAll">getAll</a></li></ul></li><li><a href="module-models_Order.html">models/Order</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Order.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~getByUserId">getByUserId</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~getByBookingId">getByBookingId</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~getAllToday">getAllToday</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~buildOrders">buildOrders</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-models_Order.html#~delete">delete</a></li></ul></li><li><a href="module-models_OrderMenus.html">models/OrderMenus</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~addMultiple">addMultiple</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~getAllByUserId">getAllByUserId</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~getAllWaiting">getAllWaiting</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~getBookingMenusByUserId">getBookingMenusByUserId</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~getBookingMenusByBookingId">getBookingMenusByBookingId</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~getAllByOrderId">getAllByOrderId</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~buildOrderMenus">buildOrderMenus</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~updateMenusToReadyByOrder">updateMenusToReadyByOrder</a></li><li data-type='method' style='display: none;'><a href="module-models_OrderMenus.html#~updateMenuToWaitingByOrder">updateMenuToWaitingByOrder</a></li></ul></li><li><a href="module-models_Payment.html">models/Payment</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Payment.html#~payTakeAway">payTakeAway</a></li><li data-type='method' style='display: none;'><a href="module-models_Payment.html#~payBooking">payBooking</a></li></ul></li><li><a href="module-models_Role.html">models/Role</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Role.html#~getByName">getByName</a></li><li data-type='method' style='display: none;'><a href="module-models_Role.html#~getAll">getAll</a></li></ul></li><li><a href="module-models_SalesStatistics.html">models/SalesStatistics</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_SalesStatistics.html#~addBenefits">addBenefits</a></li><li data-type='method' style='display: none;'><a href="module-models_SalesStatistics.html#~getToday">getToday</a></li><li data-type='method' style='display: none;'><a href="module-models_SalesStatistics.html#~getWeek">getWeek</a></li></ul></li><li><a href="module-models_Stock.html">models/Stock</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~addOrEdit">addOrEdit</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~getByName">getByName</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~getIdOf">getIdOf</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="module-models_Stock.html#~delete">delete</a></li></ul></li><li><a href="module-models_StockStatistics.html">models/StockStatistics</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_StockStatistics.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_StockStatistics.html#~getToday">getToday</a></li><li data-type='method' style='display: none;'><a href="module-models_StockStatistics.html#~getTodayByStockId">getTodayByStockId</a></li><li data-type='method' style='display: none;'><a href="module-models_StockStatistics.html#~getWeek">getWeek</a></li></ul></li><li><a href="module-models_Table.html">models/Table</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Table.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_Table.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_Table.html#~getByTableCapacity">getByTableCapacity</a></li><li data-type='method' style='display: none;'><a href="module-models_Table.html#~getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="module-models_Table.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-models_Table.html#~delete">delete</a></li></ul></li><li><a href="module-models_Token.html">models/Token</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Token.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_Token.html#~getNew">getNew</a></li><li data-type='method' style='display: none;'><a href="module-models_Token.html#~getUserId">getUserId</a></li></ul></li><li><a href="module-models_Unit.html">models/Unit</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_Unit.html#~getAll">getAll</a></li></ul></li><li><a href="module-models_User.html">models/User</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-models_User.html#~add">add</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~addStaff">addStaff</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~login">login</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~loginWithToken">loginWithToken</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~getStaff">getStaff</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~getByEmail">getByEmail</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~getById">getById</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~update">update</a></li><li data-type='method' style='display: none;'><a href="module-models_User.html#~deleteStaff">deleteStaff</a></li></ul></li><li><a href="module-Checkers.html">Checkers</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isDefined">isDefined</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~strInRange">strInRange</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isGreaterThan">isGreaterThan</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isDateLowerThan">isDateLowerThan</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isEmail">isEmail</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isPasswordSafe">isPasswordSafe</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isString">isString</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isEmptyString">isEmptyString</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isNumber">isNumber</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isArray">isArray</a></li><li data-type='method' style='display: none;'><a href="module-Checkers.html#~isDate">isDate</a></li></ul></li><li><a href="module-Converters.html">Converters</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Converters.html#~toNumber">toNumber</a></li><li data-type='method' style='display: none;'><a href="module-Converters.html#~toDate">toDate</a></li></ul></li><li><a href="module-Functions.html">Functions</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Functions.html#~getFieldsToUpdate">getFieldsToUpdate</a></li><li data-type='method' style='display: none;'><a href="module-Functions.html#~convertValue">convertValue</a></li></ul></li><li><a href="module-Mail.html">Mail</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Mail.html#~sendPassword">sendPassword</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="config.html">config</a></li></ul><h3>Global</h3><ul><li><a href="global.html#startServer">startServer</a></li><li><a href="global.html#getStartedMessage">getStartedMessage</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">api/models/Measurement.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module models/Measurement
 * @description Measurement is a module that makes the junction between
 * @see {@link module:models/MeasurementType} and {@link module:models/MeasurementUnit}.
 */
import converters from "convert-units";
import MeasurementUnit from "./MeasurementUnit.js";
import Checkers from "../../global/Checkers.js";
import ModelError from "../../global/ModelError.js";

/**
 * An un-built Measurement
 * @typedef {Object} UnbuiltMeasurement
 * @property {Number} unit_id - ID of the unit
 * @property {string} name - Unit name
 * @property {Boolean|Number} used_in_stock - Is a valid measurement unit in the stock ?
 * @property {Number} type_id - ID of the type
 * @property {string} type_name - Type name
 * @property {Number} as_ref_unit - How much of this unit relative to the reference unit of its type
 */

/**
 * A Measurement
 * @typedef {Object} Measurement
 * @property {MeasurementUnit} unit - Unit
 * @property {MeasurementType} type - Type
 */

/*****************************************************
 * Conversions table
 *****************************************************/

const conversions = {
	"kg": mass => mass,
	"g": mass => converters(mass).from("kg").to("g"),
	"mg": mass => converters(mass).from("kg").to("mg"),
	"L": volume => volume,
	"cL": volume => converters(volume).from("l").to("cl"),
	"mL": volume => converters(volume).from("l").to("ml"),
	"oz": mass => converters(mass).from("kg").to("oz"),
	"lb": mass => converters(mass).from("kg").to("lb"),
	"qt": volume => volume,
	"fl-oz": volume => converters(volume).from("l").to("fl-oz"),
	"cuill. café": value => converters(value).from("kg").to("g") / 5,
	"cuill. soupe": value => converters(value).from("kg").to("g") / 15,
	"noisette": mass => converters(mass).from("kg").to("g") / 4,
	"noix": mass => converters(mass).from("kg").to("g") / 15,
	"stick de beurre": mass => converters(mass).from("kg").to("g") / 113,
	"1 cup": volume => converters(volume).from("l").to("ml") / 250,
	"1/2 cup": volume => converters(volume).from("l").to("ml") / 125,
	"1/3 cup": volume => converters(volume).from("l").to("ml") / 80,
	"1/4 cup": volume => converters(volume).from("l").to("ml") / 60,
	"pincée": mass => converters(mass).from("kg").to("g") / 5
};

/*****************************************************
 * CRUD Methods
 *****************************************************/

/* ---- READ ---------------------------------- */
/**
 * @async
 * @function getById
 * @description Get a measurement by its ID
 *
 * @param {Promise&lt;void>} db - Database connection
 * @param {Number|string} unit_id - unit_id - ID of the unit
 * @returns {Promise&lt;MeasurementUnit>} A measurement
 *
 * @example
 * 	Measurement.getById(db, 12)
 */
const getById = async (db, unit_id) => {
	const measurement = await db.query(`
		SELECT
			mu.unit_id,
			mu.name,
			mu.used_in_stock,
			mt.type_id,
			mt.ref_unit_id,
			mt.name AS "type_name",
			mut.as_ref_unit
		FROM measurement_units_types mut
		INNER JOIN measurement_units mu ON mut.unit_id = mu.unit_id
		INNER JOIN measurement_types mt ON mut.type_id = mt.type_id
		WHERE mu.unit_id = ?
	`, [unit_id]);

	return measurement[0]
		? buildMeasurement(db, measurement[0])
		: new ModelError(400, `Aucune unité de mesure n'a été trouvée avec l'ID "${unit_id}"`);
};

/**
 * @async
 * @function getByName
 * @description Get a measurement by its name
 *
 * @param {Promise&lt;void>} db - Database connection
 * @param {string} name - Unit name
 * @returns {Promise&lt;MeasurementUnit>} A measurement
 *
 * @example
 * 	Measurement.getByName(db, "kg")
 */
const getByName = async (db, name) => {
	const measurement = await db.query(`
		SELECT
			mu.unit_id,
			mu.name,
			mu.used_in_stock,
			mt.type_id,
			mt.ref_unit_id,
			mt.name AS "type_name",
			mut.as_ref_unit
		FROM measurement_units_types mut
		INNER JOIN measurement_units mu ON mut.unit_id = mu.unit_id
		INNER JOIN measurement_types mt ON mut.type_id = mt.type_id
		WHERE mu.name = ?
	`, [name]);

	return measurement[0]
		? buildMeasurement(db, measurement[0])
		: new ModelError(400, `Aucune unité de mesure n'a été trouvée avec le nom "${name}"`);
};

/**
 * @async
 * @function getAll
 * @description Get all measurement
 *
 * @param {Promise&lt;void>} db - Database connection
 * @param {Boolean} forStock - It is needed to exclude units that should not be showed in stock
 * @returns {Promise&lt;Array&lt;MeasurementUnit>>} A list of measurement
 *
 * @example
 * 	Measurement.getAll(db)
 */
const getAll = async (db, forStock) => {
	const measurements = await db.query(`
		SELECT
			mu.unit_id,
			mu.name,
			mu.used_in_stock,
			mt.type_id,
			mt.ref_unit_id,
			mt.name AS "type_name",
			mut.as_ref_unit
		FROM measurement_units_types mut
		INNER JOIN measurement_units mu ON mut.unit_id = mu.unit_id
		INNER JOIN measurement_types mt ON mut.type_id = mt.type_id
		${forStock ? "WHERE mu.used_in_stock = 1" : ""}
		ORDER BY mut.mut_id
	`);

	return buildMeasurement(db, measurements);
};

/**
 * @async
 * @function getAllByTypes
 * @description Get all measurement ordered by types
 *
 * @param {Promise&lt;void>} db - Database connection
 * @param {Boolean} forStock - It is needed to exclude units that should not be showed in stock
 * @returns {Promise&lt;Object&lt;Array&lt;MeasurementUnit>>>} A list of measurement ordered by types
 *
 * @example
 * 	Measurement.getAllByTypes(db)
 */
const getAllByTypes = async (db, forStock) => {
	const measurements = await db.query(`
		SELECT
			mu.unit_id,
			mu.name,
			mu.used_in_stock,
			mt.type_id,
			mt.ref_unit_id,
			mt.name AS "type_name",
			mut.as_ref_unit
		FROM measurement_units_types mut
		INNER JOIN measurement_units mu ON mut.unit_id = mu.unit_id
		INNER JOIN measurement_types mt ON mut.type_id = mt.type_id
		${forStock ? "WHERE mu.used_in_stock = 1" : ""}
		ORDER BY mut.mut_id
	`);

	return buildMeasurement(db, measurements, true);
};

/**
 * @async
 * @function convert
 * @description Convert a measurement unit to another one
 *
 * @param {Promise&lt;void>} db - Database connection
 * @param {Number} value - The value to convert
 * @param {string} from - Current measurement unit of the value
 * @param {string} to - Wanted measurement unit for the value
 * @returns {Promise&lt;Number|ModelError>} The converted value or a ModelError
 *
 * @example
 * 	Measurement.convert(db, 1, "kg", "cuill. soupe")
 */
const convert = async (db, value, from, to) => {
	if (from === to) return value;

	const fromUnit = await getByName(db, from);
	const toUnit = await getByName(db, to);

	// Return a model error if one of the unit doesn't exist
	if (fromUnit instanceof ModelError) return fromUnit;
	if (toUnit instanceof ModelError) return toUnit;

	// Return a model error if one of the unit is a part of "other" type.
	if (fromUnit.type.name === "autre") return new ModelError(400, `L'unité "${fromUnit.unit.name}" ne peut pas être convertie.`);
	if (toUnit.type.name === "autre") return new ModelError(400, `L'unité "${toUnit.unit.name}" ne peut pas être convertie.`);

	// Convert the value to the reference unit
	const fromRefUnit = value * fromUnit.unit.as_ref_unit;

	// Tries to convert to the wanted unit
	if (!Object.prototype.hasOwnProperty.call(conversions, toUnit.unit.name)) {
		return new ModelError(400, `Impossible de convertir de "${fromUnit.unit.name}" (${fromUnit.type.name}) vers "${toUnit.unit.name}" (${fromUnit.type.name}).`);
	}

	return conversions[toUnit.unit.name](fromRefUnit);
};

/**
 * @function buildMeasurement
 * @description Replace foreign keys by the corresponding data
 *
 * @param {Promise&lt;void>} db - Database connection
 * @param {Array&lt;UnbuiltMeasurement>|UnbuiltMeasurement} measurements - One or multiple measurement unit and type
 * @param {Boolean} groupByType - Group by measurements types or not
 * @returns {Promise&lt;Array&lt;Measurement>|Measurement>} One or multiple measurements
 *
 * @example
 * 	Measurement.buildMeasurement(db, [&lt;UnbuiltMeasurement>, &lt;UnbuiltMeasurement>, ...])
 *Measurement.buildMeasurement(db, &lt;UnbuiltMeasurement>)
 */
const buildMeasurement = async (db, measurements, groupByType = false) => {
	const build = async measurement => {
		const refUnit = await MeasurementUnit.getById(db, measurement.ref_unit_id);

		return {
			unit: {
				unit_id: measurement.unit_id,
				name: measurement.name,
				used_in_stock: measurement.used_in_stock,
				as_ref_unit: measurement.as_ref_unit
			},
			type: {
				type_id: measurement.type_id,
				ref_unit_id: measurement.ref_unit_id,
				ref_unit: refUnit.name,
				name: measurement.type_name
			}
		};
	};

	const measurementsTypes = {};

	if (Checkers.isArray(measurements)) {
		const fullMeasurements = [];

		for (const measurement of measurements) {

			if (groupByType) {
				if (!Object.prototype.hasOwnProperty.call(measurementsTypes, measurement.type_name)) {
					measurementsTypes[measurement.type_name] = [];
				}

				measurementsTypes[measurement.type_name].push(await build(measurement));
			} else {
				fullMeasurements.push(await build(measurement));
			}
		}

		return groupByType ? measurementsTypes : fullMeasurements;
	} else {
		if (groupByType) {
			measurementsTypes[measurements.type_name] = await build(measurements);
		}

		return groupByType ? measurementsTypes : await build(measurements);
	}
};

/*****************************************************
 * Export
 *****************************************************/

const Measurement = { getById, getByName, getAll, getAllByTypes, convert };
export default Measurement;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sun Jun 13 2021 17:57:05 GMT+0200 (heure d’été d’Europe centrale) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
